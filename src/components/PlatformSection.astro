---
import { getLocaleFromUrl, getTranslations } from '../i18n';

const locale = getLocaleFromUrl(Astro.url);
const t = getTranslations(locale);
const pl = t.platform;
const p = (path: string) => locale === 'zh' ? path : `/en${path}`;
---

<style>
  .table-row-hover:hover { background-color: rgba(255, 255, 255, 0.03); }
  .tech-pill { font-family: monospace; font-size: 0.75rem; padding: 2px 6px; border-radius: 4px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); }
</style>

<main class="relative min-h-screen pt-32 pb-24 px-4">
  <div class="fixed inset-0 bg-grid-pattern cyber-grid opacity-10 pointer-events-none -z-10"></div>
  <div class="fixed top-0 left-1/2 -translate-x-1/2 w-[800px] h-[500px] bg-primary/20 blur-[120px] rounded-full pointer-events-none -z-10"></div>

  <div class="container mx-auto max-w-7xl">
    <div class="text-center mb-16">
      <div class="inline-flex items-center gap-2 px-3 py-1 rounded-full bg-surface-lighter border border-white/10 text-slate-400 text-xs font-mono uppercase tracking-wider mb-6">
        <span class="w-1.5 h-1.5 rounded-full bg-accent animate-pulse"></span>
        {pl.badge}
      </div>
      <h1 class="text-4xl md:text-6xl font-black text-white mb-6">
        {pl.title} <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary to-accent">{pl.titleHighlight}</span>
      </h1>
      <p class="text-lg text-slate-400 max-w-2xl mx-auto">{pl.subtitle}</p>
    </div>

    <div class="relative rounded-2xl border border-white/10 bg-surface-dark/50 backdrop-blur-xl overflow-hidden shadow-2xl">
      <div class="absolute top-0 left-0 w-full h-[1px] bg-gradient-to-r from-transparent via-primary/50 to-transparent"></div>
      <div class="overflow-x-auto">
        <table class="w-full text-left border-collapse">
          <thead>
            <tr class="bg-surface-lighter border-b border-white/10">
              <th class="py-5 px-6 text-sm font-bold text-slate-300 uppercase tracking-wider w-1/5">{pl.tableHeaders.capability}</th>
              <th class="py-5 px-6 text-sm font-bold text-primary uppercase tracking-wider w-1/4">{pl.tableHeaders.talon}</th>
              <th class="py-5 px-6 text-sm font-bold text-slate-500 uppercase tracking-wider w-1/4">{pl.tableHeaders.traditional}</th>
              <th class="py-5 px-6 text-sm font-bold text-accent uppercase tracking-wider w-1/4">{pl.tableHeaders.advantage}</th>
            </tr>
          </thead>
          <tbody class="divide-y divide-white/5">
            {pl.engines.map((engine: any) => (
              <tr class="table-row-hover transition-colors group">
                <td class="py-6 px-6">
                  <div class="flex items-center gap-3">
                    <div class={`w-8 h-8 rounded bg-${engine.color}-500/10 flex items-center justify-center text-${engine.color}-400`}>
                      <span class="material-symbols-outlined text-lg">{engine.icon}</span>
                    </div>
                    <span class="font-bold text-white">{engine.label}</span>
                  </div>
                </td>
                <td class="py-6 px-6">
                  <div class="flex flex-col gap-1.5">
                    <span class="font-bold text-white">{engine.name}</span>
                    <div class="flex gap-2">
                      {engine.tags.map((tag: string) => (
                        <span class={`tech-pill text-${engine.color}-300`}>{tag}</span>
                      ))}
                    </div>
                  </div>
                </td>
                <td class="py-6 px-6">
                  <div class="text-slate-400 font-mono text-sm">{engine.compat}</div>
                </td>
                <td class="py-6 px-6">
                  <div class="flex items-center gap-2 text-green-400 font-medium text-sm">
                    <span class="material-symbols-outlined text-base">{engine.advantageIcon}</span>
                    {engine.highlight}
                  </div>
                </td>
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>

    <div class="mt-16 text-center">
      <div class="inline-flex items-center gap-4 p-4 rounded-xl bg-surface-lighter border border-white/10 mx-auto">
        <div class="flex -space-x-3">
          <div class="w-10 h-10 rounded-full bg-blue-500/20 border-2 border-surface-dark flex items-center justify-center text-xs">SQL</div>
          <div class="w-10 h-10 rounded-full bg-teal-500/20 border-2 border-surface-dark flex items-center justify-center text-xs">KV</div>
          <div class="w-10 h-10 rounded-full bg-purple-500/20 border-2 border-surface-dark flex items-center justify-center text-xs">Vec</div>
          <div class="w-10 h-10 rounded-full bg-surface-dark border-2 border-surface-dark flex items-center justify-center text-xs text-slate-500">+5</div>
        </div>
        <span class="text-xl font-bold text-white">{pl.cta}</span>
        <a href={p('/download')} class="ml-4 h-10 px-6 rounded-lg bg-white text-[#0a0a0f] font-bold hover:bg-slate-200 transition-colors flex items-center">
          {pl.ctaBtn}
        </a>
      </div>
    </div>
  </div>
</main>
