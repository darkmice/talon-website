---
import { getLocaleFromUrl, getTranslations } from '../i18n';

const locale = getLocaleFromUrl(Astro.url);
const t = getTranslations(locale);
const pr = t.pricing;
const p = (path: string) => locale === 'zh' ? path : `/en${path}`;
---

<section class="relative pt-32 pb-16 flex flex-col items-center justify-center overflow-hidden">
  <div class="absolute inset-0 bg-grid-pattern cyber-grid opacity-20 pointer-events-none"></div>
  <div class="absolute inset-0 bg-radial-glow pointer-events-none"></div>
  <div class="relative z-10 container mx-auto px-4 flex flex-col items-center text-center gap-6 max-w-5xl">
    <h1 class="text-4xl md:text-6xl lg:text-7xl font-black leading-tight tracking-tighter text-white">
      {pr.title} <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary via-secondary to-accent text-glow">{pr.titleHighlight}</span>
    </h1>
    <p class="text-lg md:text-xl text-slate-400 max-w-2xl leading-relaxed">{pr.subtitle}</p>
  </div>
</section>

<section class="pb-24 px-4">
  <div class="container mx-auto max-w-7xl">
    <!-- Pricing Cards -->
    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 max-w-6xl mx-auto mb-24">
      <!-- Free -->
      <div class="bento-card rounded-3xl p-8 border border-white/5 flex flex-col h-full">
        <div class="mb-6">
          <span class="material-symbols-outlined text-slate-400 text-3xl">person</span>
        </div>
        <h3 class="text-xl font-bold text-white mb-1">{pr.free.name}</h3>
        <p class="text-slate-500 text-sm mb-6">{pr.free.desc}</p>
        <div class="mb-8">
          <span class="text-4xl font-black text-white">{pr.free.price}</span>
        </div>
        <ul class="space-y-3 mb-8 flex-grow">
          {pr.free.features.map((f: string) => (
            <li class="flex items-center gap-2 text-sm text-slate-300">
              <span class="material-symbols-outlined text-green-400 text-base">check_circle</span>
              {f}
            </li>
          ))}
        </ul>
        <a href={p('/download')} class="w-full h-12 rounded-lg bg-surface-lighter border border-white/10 text-white font-bold hover:bg-white/10 transition-all flex items-center justify-center">
          {pr.free.cta}
        </a>
      </div>

      <!-- Pro (Featured) -->
      <div class="bento-card rounded-3xl p-8 border border-primary/30 flex flex-col h-full relative overflow-hidden">
        <div class="absolute top-0 right-0 w-48 h-48 bg-primary/20 blur-[80px] rounded-full pointer-events-none"></div>
        <div class="absolute top-4 right-4">
          <span class="px-3 py-1 rounded-full bg-primary/20 text-primary text-xs font-mono font-bold border border-primary/30">{pr.popular}</span>
        </div>
        <div class="mb-6 relative z-10">
          <span class="material-symbols-outlined text-primary text-3xl">rocket_launch</span>
        </div>
        <h3 class="text-xl font-bold text-white mb-1 relative z-10">{pr.pro.name}</h3>
        <p class="text-slate-500 text-sm mb-6 relative z-10">{pr.pro.desc}</p>
        <div class="mb-8 relative z-10">
          <span class="text-4xl font-black text-white">{pr.pro.price}</span>
          <span class="text-slate-500 text-lg">{pr.pro.period}</span>
        </div>
        <ul class="space-y-3 mb-8 flex-grow relative z-10">
          {pr.pro.features.map((f: string) => (
            <li class="flex items-center gap-2 text-sm text-slate-300">
              <span class="material-symbols-outlined text-primary text-base">check_circle</span>
              {f}
            </li>
          ))}
        </ul>
        <a href={p('/quickstart')} class="w-full h-12 rounded-lg bg-primary text-white font-bold hover:bg-primary/90 hover:shadow-[0_0_20px_rgba(55,19,236,0.5)] transition-all relative z-10 flex items-center justify-center">
          {pr.pro.cta}
        </a>
      </div>

      <!-- Enterprise -->
      <div class="bento-card rounded-3xl p-8 border border-white/5 flex flex-col h-full">
        <div class="mb-6">
          <span class="material-symbols-outlined text-slate-400 text-3xl">apartment</span>
        </div>
        <h3 class="text-xl font-bold text-white mb-1">{pr.enterprise.name}</h3>
        <p class="text-slate-500 text-sm mb-6">{pr.enterprise.desc}</p>
        <div class="mb-8">
          <span class="text-4xl font-black text-white">{pr.enterprise.price}</span>
        </div>
        <ul class="space-y-3 mb-8 flex-grow">
          {pr.enterprise.features.map((f: string) => (
            <li class="flex items-center gap-2 text-sm text-slate-300">
              <span class="material-symbols-outlined text-accent text-base">check_circle</span>
              {f}
            </li>
          ))}
        </ul>
        <a href={p('/pricing')} class="w-full h-12 rounded-lg bg-surface-lighter border border-white/10 text-white font-bold hover:bg-white/10 transition-all flex items-center justify-center">
          {pr.enterprise.cta}
        </a>
      </div>
    </div>

    <!-- Feature Comparison Table -->
    <div class="max-w-5xl mx-auto">
      <div class="text-center mb-12">
        <h2 class="text-3xl font-bold text-white mb-2">{pr.comparison.title}</h2>
        <p class="text-slate-400">{pr.comparison.subtitle}</p>
      </div>
      <div class="overflow-x-auto">
        <table class="w-full text-sm">
          <thead>
            <tr class="border-b border-white/10">
              {pr.comparison.headers.map((h: string, i: number) => (
                <th class={`py-4 px-4 text-left font-bold ${i === 0 ? 'text-slate-400' : 'text-white'}`}>{h}</th>
              ))}
            </tr>
          </thead>
          <tbody>
            {pr.comparison.rows.map((row: string[]) => (
              <tr class="border-b border-white/5 hover:bg-surface-lighter/30 transition-colors">
                {row.map((cell: string, i: number) => (
                  <td class={`py-4 px-4 ${i === 0 ? 'text-slate-400 font-medium' : 'text-slate-300 font-mono text-xs'}`}>{cell}</td>
                ))}
              </tr>
            ))}
          </tbody>
        </table>
      </div>
    </div>
  </div>
</section>
